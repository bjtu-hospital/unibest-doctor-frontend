# 医生接诊界面设计文档

## 项目概述
开发一个医生端使用的工作平台，使用unibest进行开发，需要设计一个医生接诊的界面。以专业的UI设计师角度，通过业务流程，设计一套美观且专业的医生接诊界面。

---

## 业务流程描述

### 医生接诊页面（手机端）

#### 业务流程：

1. **获取医生的接诊信息**
   - 按照列表的形式获取所有的预约号
   - 获取号源的数量、就诊人数

2. **当前就诊人卡片**
   - 卡片显示当前的就诊人
   - 右侧小字显示下一位就诊人
   - 有个按钮，点击可以查看所有的就诊人顺序

3. **查看患者信息**
   - 点击患者，可以查看患者的具体信息

4. **"下一位"按钮（绿色）**
   - 点击之后，会将当前的患者标记就诊完成
   - 并且开始就诊下一位患者

5. **"过号"按钮（红色）**
   - 点击之后，会将当前患者标记为"过号"
   - 并且放到队尾，记录过号一次
   - 如果过号次数>=2，那么这个号会作废

6. **队列自动刷新**
   - 队列应该可以经常被刷新
   - 给用户的体验能比较丝滑和流畅
   - 自动刷新，如果有更新就动态更改队列

7. **加号申请功能**
   - 医生点击后可以选择申请加号
   - 选择加号人的信息
   - 选中加号的位置
   - 然后为其提交加号申请

---

## 接口定义与数据格式

### 2.1 查询自己的排班信息

**查询当日排班** - 医生只能查自己的，管理员可以查所有人

#### Parameters
| Name | Description |
| :--- | :---------- |
| doctor_id integer \| (integer \| null)(query) | 医生ID |

#### Request Example

**Curl**
```bash
curl -X 'GET' \
  'http://localhost:8000/doctor/schedules/today?doctor_id=001' \
  -H 'accept: application/json' \
  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMTMiLCJsb2dpbl90aW1lIjoxNzY0MjQ5NDM3LCJsb2dpbl9pcCI6IjEyNy4wLjAuMSIsInVzZXJfdHlwZSI6ImRvY3RvciIsImV4cCI6MTc2NDMzNTgzN30.KfAaikWT9S7H7pu-7Pahiij8T5z5JsOIKyXRKlyFJMI'
```

**Request URL**
```
http://localhost:8000/doctor/schedules/today?doctor_id=001
```

#### Response

| Code | Details |
| ---- | ------- |
| 200  | Response body<br>```json<br>{<br>  "code": 0,<br>  "message": {<br>    "schedules": []<br>  }<br>}<br>``` |

---

### 2.2 获取接诊队列信息（核心接口）

- **描述**：获取当前排班的所有状态数据（统计、当前人、队列列表）
- **方法**：`GET`
- **路径**：`/doctor/consultation/queue`
- **参数**：
  - `schedule_id`: (String/Number) 排班ID

- **返回数据** (message 结构)：

```json
{
  "stats": {
    "totalSlots": 50,      // 总号源
    "waitingCount": 5,     // 候诊人数
    "completedCount": 10,  // 已完成人数
    "passedCount": 1       // 过号人数
  },
  "currentPatient": {      // 当前就诊人 (可为 null)
    "orderId": "1001",
    "patientId": "P001",
    "patientName": "张三",
    "queueNumber": "A005",
    "gender": "男",
    "age": 30,
    "visitTime": "10:00",
    "passCount": 0
  },
  "nextPatient": {         // 下一位候诊人预览 (可为 null)
    "patientName": "李四",
    "queueNumber": "A006"
  },
  "queue": [ ... ],        // 正常候诊列表 (Array)
  "waitlist": [ ... ],     // 过号等待列表 (Array)
  "completedList": [ ... ],// 已完成列表 (Array)
  "invalidList": [ ... ]   // 作废列表 (Array)
}
```

---

### 2.3 呼叫下一位（包含完成当前）

- **描述**：将当前患者（若有）设为完成，并呼叫队列中的下一位
- **方法**：`POST`
- **路径**：`/doctor/consultation/next`
- **参数**：
  - `schedule_id`: (String/Number) 排班ID
- **返回数据**：成功提示信息

---

### 2.4 患者过号

- **描述**：将指定排队订单标记为过号
- **方法**：`POST`
- **路径**：`/doctor/consultation/pass`
- **参数**：
  - `patient_order_id`: (String/Number) 患者的排队订单ID (`orderId`)
- **返回数据**：成功提示信息

---

### 2.5 申请加号

- **描述**：医生手动为患者加号
- **方法**：`POST`
- **路径**：`/doctor/consultation/add`
- **参数**：

```json
{
  "schedule_id": "2971",
  "patient_id": "P999",
  "priority": 1,        // 1: 队尾(普通), 0: 下一位(优先)
  "reason": "复诊加号"
}
```

- **返回数据**：成功提示信息

---

### 2.6 搜索患者

- **描述**：用于加号时查找患者
- **方法**：`GET`
- **路径**：`/patients`
- **参数**：
  - `name`: (String) 搜索关键词（姓名）

- **返回数据**：

```json
{
  "patients": [
    {
      "patient_id": "P001",
      "name": "王五",
      "gender": "男",
      "age": 25,
      "phone": "13800000000"
    }
  ]
}
```